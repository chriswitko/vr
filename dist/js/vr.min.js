!function(e,t){top!=self&&top.location.replace(self.location.href);var a=e(t),r=e("body"),i=e(document),o={ensureValidProtocol:function(e,t){var a=e.val().substring(0,4),r=e.parent(),i=new RegExp("://");r.removeClass("error"),i.test(e.val())&&"http"!=a&&(e.focus().select(),r.addClass("error"),t.stopPropagation(),t.preventDefault())},createBookmarklet:function(){var e,a=document.title,r=t.location.href;t.sidebar?t.sidebar.addPanel(a,r):t.external?t.external.AddFavorite(r,a):t.opera&&t.print&&(e=document.createElement("a"),e.setAttribute("href",r),e.setAttribute("title",a),e.setAttribute("rel","sidebar"),e.click())},getParameterByName:function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),a=t.exec(location.search);return null===a?"":decodeURIComponent(a[1].replace(/\+/g," "))},init:function(){delete this.init,e('[rel="bookmark"]').attr("href","javascript:document.location='"+document.location+"?url=' + document.location.href;"),this.$loader=e("#vrLoader"),this.$frame=e("#vrFrame"),c(),this.parseUrl(),n()},parseUrl:function(){var t=this.url=this.getParameterByName("url");t.length>0&&("http"!=t.substr(0,4)&&(t="http://"+t),this.url=t,e('[name="url"]').val(this.url),this.showLoader(),this.$frame.attr("src",this.url),e("#indexPage").hide(),e("#vrPage").show())},showLoader:function(){this.$frame.addClass("hidden"),this.$loader.removeClass("hidden")},hideLoader:function(){this.$frame.removeClass("hidden"),this.$loader.addClass("hidden")}},n=function(){var t=e.cookie("vr-device"),a=e.cookie("vr-orientation");t&&e('[data-device="'+t+'"]').trigger("click"),"landscape"===a&&e("#btnToggleRotate").trigger("click")},c=function(){var t=e("button[data-viewport-width]"),n=o.$frame,c=e("button[data-rotate=true]"),s=e("#vr"),l=function(){e("#closeResizer").length>0?d():document.location=document.getElementById("btnVRClose").getAttribute("href")},d=function(){var e=a.width(),r=a.height();t.removeClass("active"),n.css({"max-width":e,"max-height":r}),s.fadeOut(500,function(){document.location=n[0].contentWindow.location.href})};n.on("load",function(e){o.hideLoader()}),r.on("click","button[data-viewport-width]",function(a){var r=this.getAttribute("data-viewport-width"),i=this.getAttribute("data-viewport-height"),o=e(this),c=this.getAttribute("data-device");return t.removeClass("active"),o.addClass("active"),e.cookie("vr-device",c),n.css({"max-width":r,"max-height":i}),a.preventDefault(),!1}).on("click","button.rotate",function(t){c.each(function(){var t=e(this).toggleClass("landscape"),a=t.attr("data-viewport-width"),r=t.attr("data-viewport-height");t.attr("data-viewport-width",r),t.attr("data-viewport-height",a),t.hasClass("active")&&(t.trigger("click"),t.hasClass("landscape")?e.cookie("vr-orientation","landscape"):e.removeCookie("vr-orientation"))})}).on("click","button.refresh",function(t){e(this).find('i[class*="icon-"]').addClass("icon-rotate-360"),o.showLoader(),n[0].contentWindow.location.reload(!0)}).on("click","#closeResizer",function(e){d()}).on("click","[data-toggle]",function(t){var a=e(this.getAttribute("data-toggle"));a.slideToggle(150,function(){a.is(":visible")&&a.find('[name="url"]').focus().select()})}).on("keyup","input",function(t){27==t.keyCode&&(e("[data-toggle]").first().trigger("click"),e('[name="url"]').val(o.url)),t.stopPropagation()}).on("keypress",'[name="url"]',function(t){13==t.keyCode&&o.ensureValidProtocol(e(this),t)}).on("click",'button[type="submit"]',function(t){o.ensureValidProtocol(e(this).parents("form").find('[name="url"]'),t)}).on("click",'[rel="bookmark"]',function(e){return e.preventDefault(),!1}),i.on("keyup",function(t){switch(t.keyCode){case 27:e("[data-toggle]").first().trigger("click");break;case 49:e('[data-device="fullscreen"]').trigger("click");break;case 50:e('[data-device="desktop"]').trigger("click");break;case 51:e('[data-device="macbook"]').trigger("click");break;case 52:e('[data-device="ipad"]').trigger("click");break;case 53:e('[data-device="tablet"]').trigger("click");break;case 54:e('[data-device="android"]').trigger("click");break;case 55:e('[data-device="iphone"]').trigger("click");break;case 32:case 56:case 82:e(".rotate").trigger("click");break;case 88:l()}}),e("form").on("submit",function(t){var a=e(this).find(['name="url"']),r=a.parent();return r.removeClass("error"),""===a.val()?(r.addClass("error"),t.preventDefault(),t.stopPropagation(),!1):void 0})};e(function(){o.init()})}(jQuery,window);